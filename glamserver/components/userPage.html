<div class="container-scroller">
	<div class="container-fluid page-body-wrapper">
		<div id="leftSideNavigation" style="float: left"></div>
		<div class="main-panel">
			<div class="content-wrapper">
				<div class="row">
					<div class="col-sm-12">
						<div class="home-tab">
							<div
								class="d-sm-flex align-items-center justify-content-between border-bottom"
							>
								<ul class="nav nav-tabs" role="tablist">
									<li class="nav-item">
										<a
											class="nav-link active ps-0"
											id="home-tab"
											data-bs-toggle="tab"
											href="javascript:void(0)"
											role="tab"
											aria-controls="overview"
											aria-selected="true"
											><i class="mdi mdi-settings" style="font-size: 12px;"></i> Settings</a
										>
									</li>
								</ul>
							</div>
							<div class="tab-content tab-content-basic">
								<div
									class="tab-pane fade show active"
									id="overview"
									role="tabpanel"
									aria-labelledby="overview"
								>
									<div class="row">
										<div class="col-lg-12 d-flex flex-column">
											<div class="row flex-grow">
												<div class="col-lg-6 grid-margin stretch-card">
													<div class="card">
													  <div class="card-body">
													    <h4 class="card-title">Categories</h4>
													    <div class="table-responsive">
															<table
																id="categoryTable"
																class="table table-striped"
																style="width: 100%"
															>
																<thead>
																	<tr>
																		<th>Id</th>
																		<th>Category Name</th>
																	</tr>
																</thead>
															</table>
													    </div>
													  </div>
													</div>
												</div>
												<div class="col-lg-6 grid-margin stretch-card">
													<div class="card">
													  <div class="card-body">
													    <h4 class="card-title">System Settings</h4>
													    <div class="statistics-details d-flex align-items-center justify-content-between">
															<div>
																<p class="statistics-title">Penalty</p>
																<h5 class="mb-0 fw-bold">₱<span id="penalty" data-api="g_penalty" contenteditable="true"></span> per day</h5>
															</div>
															<div>
																<p class="statistics-title">Shipping Fee</p>
																<h5 class="mb-0 fw-bold">₱<span id="shippingFee" data-api="g_shipping_fee" contenteditable="true"></span> per shipping</h5>
															</div>
															<div>
																<p class="statistics-title">Days Till Due</p>
																<h5 class="mb-0 fw-bold"><span id="daysDue" data-api="g_days_till_due" contenteditable="true"></span> day/s till due</h5>
															</div>
														</div>
														<h4 class="card-title">User Settings</h4>
														<button type="button" class="btn btn-info btn-icon-text" onclick="sessionStorage.page=0;location.reload();"><i class="icon-logout"></i> Logout</button>
													  </div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- Modal -->
<div class="modal fade bd-example-modal-lg" id="CategoryModal" tabindex="-1" role="dialog" aria-labelledby="CategoryModalTitle" aria-hidden="true">
	<div class="modal-dialog modal-s" role="document">
		<div class="modal-content" style="max-height: 500px;">
			<div class="modal-header">
			<h5 class="modal-title" id="exampleModalLongTitle">Category Record</h5>
			</div>
			<div class="modal-body" style="overflow-x: auto;">
				<div class="form-group">
					<label for="CategoryName"><i class="mdi mdi-regex text-danger"></i> Category Name</label>
					<input type="text" class="form-control" id="CategoryName" placeholder="Category name here...">
				</div>
			</div>
			<div class="modal-footer">
				<button id="saveRecord" type="button" class="btn btn-primary">Save changes</button>
			</div>
		</div>
	</div>
</div>
<script>
	function saveChanges(params) {
		$.ajax({
			type: "POST",
			url: "/glam/glamserver/assets/php/login.php",
			data: {"TYPE": "saveSettingsDetails", 'API': params[0], 'VALUE': params[1]},
			dataType: "json",
		}).done((data) => {
			if(data.STATUS == 1) {
				
			}
		});
	}

	var table = $("#categoryTable").DataTable({
		dom: "Bfrtip",
		select: true,
		buttons: [{
			text: "<i class=\"mdi mdi-file-import\"></i> New Record",
			className: "createCategoryRecord",
			action: function( e, dt, node, config ) {
				$('#CategoryModal').modal('show');
			}
		},{
			text: "<i class=\"mdi mdi-file-send\"></i> Update Selected Row",
			className: "createCategoryRecord",
			action: function( e, dt, node, config ) {
				$('#CategoryModal').modal('show');
			},
			enabled: false
		},{
			text: "<i class=\"mdi mdi-delete-forever\"></i> Delete Record",
			className: "createCategoryRecord",
			action: function( e, dt, node, config ) {
				var record = dt.row('.selected').data();
			},
			enabled: false
		},],
		lengthMenu: [
			[1, -1],
			[1, 'All'],
		],
		pagingType: 'full',
		processing: true,
		serverSide: true,
		ajax: "assets/php/settings.php",
		columns: [
				{ data: 'gcatId' },
				{ data: 'gcat_name' },
		],
		columnDefs: [
			{
				target: [0],
				visible: false,
				searchable: false,
			},
		],
		stateSave: true,
		initComplete: function () {

		}
	});

	$('#categoryTable tbody').on('click', 'tr', function () {
		var selectedRows;
		if(this.classList.value != '') {
			if ($(this).hasClass('selected')) {
				$(this).removeClass('selected');
				selectedRows = table.$('tr.selected').length;
			} else {
				table.$('tr.selected').removeClass('selected');
				$(this).addClass('selected');
				selectedRows = table.$('tr.selected').length;
			}
			table.button( 1 ).enable( selectedRows === 1 );
			table.button( 2 ).enable( selectedRows === 1 );
		}
	});

	$(document).ready(function () {
		$('#CategoryModal').modal('hide');
		$('#penalty').on('DOMSubtreeModified',event => {
			saveChanges([event.target.dataset.api,event.target.innerText]);
		});
		$('#shippingFee').on('DOMSubtreeModified',event => {
			saveChanges([event.target.dataset.api,event.target.innerText]);
		});
		$('#daysDue').on('DOMSubtreeModified',event => {
			saveChanges([event.target.dataset.api,event.target.innerText]);
		});
		$.ajax({
			type: "POST",
			url: "/glam/glamserver/assets/php/login.php",
			data: {"TYPE": "settingsDetails"},
			dataType: "json",
		}).done((data) => {
			if(data.STATUS == 1) {
				$('#penalty').text(data.Data[0].g_penalty);
				$('#shippingFee').text(data.Data[0].g_shipping_fee);
				$('#daysDue').text(data.Data[0].g_days_till_due);
			}
		});
	});
</script>